<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy birthday</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <style>
        /* Additional styles for enhanced beauty */
        body {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            overflow: hidden; /* Thêm overflow-y: hidden để ngăn scrollbar nhấp nháy */
        }
        /* Alternative dark pattern if you want to switch (comment out the pink gradient above and uncomment below) */
        /*
        body {
            background-color: #1e1e1e;
            background-image: 
                linear-gradient(45deg, #2c2c2c 25%, transparent 25%),
                linear-gradient(-45deg, #2c2c2c 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #2c2c2c 75%),
                linear-gradient(-45deg, transparent 75%, #2c2c2c 75%);
            background-size: 40px 40px;
            background-position: 0 0, 0 20px, 20px -20px, -20px 0px;
            overflow: hidden;
        }
        */
        #wrapper {
            position: relative;
            box-shadow: 0 0 20px rgba(255, 182, 193, 0.5);
            height: 100vh; /* Đảm bảo wrapper full height để tránh reflow */
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .content {
            box-shadow: inset 0 0 50px rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            margin: 20px;
            padding: 20px;
            display: flex;
            flex: 1;
            flex-direction: row; /* Mặc định row cho PC */
            justify-content: space-between;
            align-items: center;
        }
        .title h1 {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-size: 3em;
            color: #ff69b4;
        }
        .btn.mail button {
            background: linear-gradient(45deg, #ff69b4, #ff1493);
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            color: white;
            font-size: 1.2em;
            box-shadow: 0 4px 15px rgba(255, 105, 180, 0.4);
            transition: transform 0.3s;
        }
        .btn.mail button:hover {
            transform: scale(1.05);
        }
        /* Original Jumping Hello Kitty - Giữ nguyên vị trí, thêm glow để đẹp hơn */
        .hello-kitty {
            position: absolute;
            top: 20%;
            right: 10%;
            z-index: 10;
            animation: float 3s ease-in-out infinite;
            background: transparent; /* Ensure container is transparent */
            filter: drop-shadow(0 0 10px rgba(255, 105, 180, 0.8)); /* Thêm glow hồng nhạt */
        }
        .hello-kitty img {
            width: 150px;
            height: auto;
            background: transparent; /* Transparent background for img */
           mix-blend-mode: lighten;/* Hack to blend white background with page (try 'screen' if Kitty is light-colored) */
           border-radius: 20px; /* Bo góc nhẹ cho Kitty */
           transition: transform 0.3s ease; /* Mượt mà hơn khi hover nếu cần */
           max-width: 100%;
           height: auto;
        }
        .hello-kitty:hover img {
            transform: scale(1.1); /* Phóng to nhẹ khi hover để tương tác */
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        /* Hello Kitty in corners - Thêm các Hello Kitty khác ở góc, thêm glow và bo góc để đẹp hơn */
        .hello-kitty-tl {
            position: absolute;
            top: 5%;
            left: 5%;
            z-index: 10;
            animation: bounce 2.5s ease-in-out infinite;
            background: transparent;
            filter: drop-shadow(0 0 8px rgba(255, 105, 180, 0.6)); /* Glow nhẹ */
        }
        .hello-kitty-tl img {
            width: 100px;
            height: auto;
            background: transparent;
            mix-blend-mode: lighten;
            transform: rotate(10deg);
            border-radius: 15px; /* Bo góc */
            max-width: 100%;
            height: auto;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0px) rotate(10deg); }
            50% { transform: translateY(-15px) rotate(10deg); }
        }
        .hello-kitty-tr {
            position: absolute;
            top: 5%;
            right: 5%;
            z-index: 10;
            animation: float-corner 3s ease-in-out infinite;
            background: transparent;
            filter: drop-shadow(0 0 8px rgba(255, 105, 180, 0.6));
        }
        .hello-kitty-tr img {
            width: 120px;
            height: auto;
            background: transparent;
            mix-blend-mode: lighten;
            transform: rotate(-5deg);
            border-radius: 15px;
            max-width: 100%;
            height: auto;
        }
        @keyframes float-corner {
            0%, 100% { transform: translateY(0px) rotate(-5deg); }
            50% { transform: translateY(-20px) rotate(-5deg); }
        }
        .hello-kitty-bl {
            position: absolute;
            bottom: 5%;
            left: 5%;
            z-index: 10;
            animation: wave 4s ease-in-out infinite;
            background: transparent;
            filter: drop-shadow(0 0 8px rgba(255, 105, 180, 0.6));
        }
        .hello-kitty-bl img {
            width: 110px;
            height: auto;
            background: transparent;
            mix-blend-mode: lighten;
            transform: rotate(-15deg);
            border-radius: 15px;
            max-width: 100%;
            height: auto;
        }
        @keyframes wave {
            0%, 100% { transform: translateX(0px) rotate(-15deg); }
            50% { transform: translateX(10px) rotate(-15deg); }
        }
        .hello-kitty-br {
            position: absolute;
            bottom: 5%;
            right: 5%;
            z-index: 10;
            animation: spin-float 5s linear infinite;
            background: transparent;
            filter: drop-shadow(0 0 8px rgba(255, 105, 180, 0.6));
        }
        .hello-kitty-br img {
            width: 130px;
            height: auto;
            background: transparent;
            mix-blend-mode: lighten;
            transform: rotate(20deg);
            border-radius: 15px;
            max-width: 100%;
            height: auto;
        }
        @keyframes spin-float {
            0% { transform: translate(0px, 0px) rotate(20deg); }
            25% { transform: translate(5px, -10px) rotate(20deg); }
            50% { transform: translate(0px, -20px) rotate(20deg); }
            75% { transform: translate(-5px, -10px) rotate(20deg); }
            100% { transform: translate(0px, 0px) rotate(20deg); }
        }
        /* Floating hearts - Tối ưu để tránh reflow */
        .floating-heart {
            position: fixed; /* Thay absolute bằng fixed để không ảnh hưởng layout */
            width: 20px;
            height: 20px;
            color: #ff69b4;
            font-size: 20px;
            pointer-events: none;
            z-index: 5;
            animation: float-up 4s linear forwards;
        }
        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-100vh) rotate(360deg);
            }
        }
        /* Enhanced stars and flowers */
        .decorate_star {
            animation: twinkle 2s infinite alternate;
        }
        @keyframes twinkle {
            0% { opacity: 0.5; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.2); }
        }
        /* Name styling: Một dòng, không xuống dòng, font bình thường */
        .name {
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap; /* Không cho phép xuống dòng */
        }
        .name span {
            font-family: sans-serif; /* Font bình thường, đơn giản */
            font-size: 1.8em; /* Kích thước nổi bật */
            color: white; /* Màu trắng */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* Bóng chữ đậm hơn cho tương phản */
            margin: 0 10px; /* Khoảng cách với icon tim */
            animation: subtleBlink 3s ease-in-out infinite; /* Nhấp nháy chậm và nhẹ cho chữ */
        }
        .name i {
            color: #ff1493; /* Màu tim hồng đậm hơn */
            font-size: 1.5em;
            animation: heartBeat 1.5s ease-in-out infinite; /* Hiệu ứng tim đập cho icon */
        }
        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        @keyframes subtleBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; } /* Nhấp nháy nhẹ và chậm */
        }
        /* Hiệu ứng pháo hoa nổ - Canvas cho confetti */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 20;
        }
        /* Hide on mobile to avoid overlap */
        @media (max-width: 768px) {
            /* Scale up toàn bộ nội dung trên mobile để hiển thị đầy đủ hơn */
            #wrapper {
                transform: scale(1.1); /* Scale nhẹ để nội dung lớn hơn, điều chỉnh nếu cần */
                transform-origin: top left;
            }
            .hello-kitty-tl, .hello-kitty-tr, .hello-kitty-bl, .hello-kitty-br {
                display: none;
            }
            .name span {
                font-size: 2em; /* Tăng size chữ tên trên mobile */
            }
            /* Responsive cho .content: Stack vertically */
            .content {
                flex-direction: column !important;
                text-align: center;
                margin: 5px; /* Giảm margin để chiếm nhiều không gian hơn */
                padding: 15px;
                transform: scale(1.05); /* Scale nhẹ cho content */
            }
            .left, .right {
                width: 100%;
                margin-bottom: 10px; /* Giảm margin bottom */
            }
            .title h1 {
                font-size: 2.5em; /* Tăng font size cho title */
            }
            .btn.mail button {
                padding: 15px 30px; /* Giữ padding lớn hơn */
                font-size: 1.2em; /* Tăng font size button */
            }
            .flag__birthday {
                display: flex;
                justify-content: center;
                gap: 5px; /* Giảm gap để fit hơn */
                flex-wrap: wrap; /* Thêm wrap để tránh overflow nếu cần */
                padding: 0 5px;
                transform: scale(1.1); /* Scale flag */
            }
            .flag__birthday img {
                width: 200px !important; /* Tăng width flag trên mobile */
                height: auto;
                flex: 1;
                min-width: 150px; /* Tăng min-width */
            }
            .box__account .image img {
                width: 90%; /* Tăng width ảnh account */
                max-width: 250px;
                height: auto;
                position: relative;
                bottom: -10px;
            }
            .balloon_one img, .balloon_two img {
                width: 80px; /* Tăng size balloon */
                height: auto;
            }
            .hello-kitty {
                top: 10%;
                right: 5%;
            }
            .hello-kitty img {
                width: 120px; /* Tăng size Kitty chính */
            }
            .cricle .text__cricle {
                font-size: 1em; /* Tăng font size cricle */
            }
            .date__of__birth span {
                font-size: 1.5em; /* Tăng size date */
            }
            .decorate_star, .decorate_flower--one img, .decorate_flower--two img, .decorate_flower--three img {
                transform: scale(0.9); /* Tăng scale decorate */
            }
            .decorate_bottom img, .smiley__icon img {
                width: 80px; /* Tăng size bottom icons */
            }
            /* Modal responsive */
            #nameModal .modal-content {
                width: 95%;
                padding: 20px;
                transform: scale(1.1);
            }
            #nameInput {
                width: 100%;
                padding: 12px; /* Tăng padding input */
                margin: 10px 0;
                font-size: 1.1em;
            }
            #submitName {
                width: 100%;
                padding: 12px;
                font-size: 1.1em;
            }
            /* Letter box responsive */
            .box__letter .letter__border {
                width: 98%; /* Tăng width letter box */
                max-width: 500px;
                margin: 0 auto;
            }
            .content__letter {
                flex-direction: column;
                text-align: center;
            }
            .left, .right {
                width: 100%;
            }
            .love__img img {
                width: 180px; /* Tăng size love img */
            }
            #mewmew {
                width: 80px; /* Tăng size mewmew */
            }
            .text__letter p {
                font-size: 1.2em; /* Tăng font size letter text */
                line-height: 1.5;
            }
        }

        @media (max-width: 480px) {
            /* Scale mạnh hơn cho màn nhỏ */
            #wrapper {
                transform: scale(1.15);
            }
            .title h1 {
                font-size: 2em; /* Tăng thêm cho 480px */
            }
            .name span {
                font-size: 1.6em;
            }
            .flag__birthday {
                gap: 3px;
            }
            .flag__birthday img {
                width: 160px !important; /* Tăng width flag nhỏ hơn */
            }
            .content {
                margin: 3px;
                padding: 12px;
                transform: scale(1.1);
            }
            .btn.mail button {
                padding: 12px 25px;
                font-size: 1.1em;
            }
            .box__account .image img {
                width: 85%;
                max-width: 200px;
            }
            .hello-kitty img {
                width: 100px;
            }
            .love__img img {
                width: 150px;
            }
            .text__letter p {
                font-size: 1.1em;
            }
            .date__of__birth span {
                font-size: 1.3em;
            }
        }

        /* Thêm media query cho màn hình rất nhỏ (dưới 360px) */
        @media (max-width: 360px) {
            #wrapper {
                transform: scale(1.2); /* Scale lớn hơn cho màn rất nhỏ */
            }
            .flag__birthday img {
                width: 140px !important;
            }
            .title h1 {
                font-size: 1.8em;
            }
            .name span {
                font-size: 1.4em;
                white-space: normal; /* Cho phép wrap nếu cần trên màn nhỏ */
            }
            .content {
                padding: 10px;
            }
            .text__letter p {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <canvas id="confetti-canvas"></canvas> <!-- Canvas cho pháo hoa -->

    <div id="wrapper">
        <!-- Hello Kitty in 4 corners - Thêm mới -->
        <div class="hello-kitty-tl">
            <img src="images/hellokiity4.gif" alt="Hello Kitty Top Left"> <!-- Thay bằng GIF của bạn -->
        </div>
        <div class="hello-kitty-tr">
            <img src="images/hello-kitty-sticker-15.gif" alt="Hello Kitty Top Right"> <!-- Thay bằng GIF của bạn -->
        </div>
        <div class="hello-kitty-bl">
            <img src="images/hello-kitty-sticker-18.gif" alt="Hello Kitty Bottom Left"> <!-- Thay bằng GIF của bạn -->
        </div>
        <div class="hello-kitty-br">
            <img src="images/hellokitty6.gif" alt="Hello Kitty Bottom Right"> <!-- Thay bằng GIF của bạn -->
        </div>

        <div id="nameModal" class="modal">
            <div class="modal-content">
                <h2>Vợ nhập tên đi</h2>
                <input type="text" id="nameInput" placeholder="Nhập tên">
                <button id="submitName">Xác nhận</button>
            </div>
        </div>
        <div class="flag__birthday">
            <img src="./images/1.png" alt="" width="350" class="flag__left">
            <img src="./images/1.png" alt="" width="350" class="flag__right">
        </div>
        <div class="content" style="display:none;">
            <div class="left">
                <div class="title">
                    <h1 class="happy">
                        <span style="--t: 4s;">H</span>
                        <span style="--t: 4.2s;">a</span>
                        <span style="--t: 4.4s;">p</span>
                        <span style="--t: 4.6s;">p</span>
                        <span style="--t: 4.8s;">
                            y
                            <div class="hat">
                                <img src="./images/hat.png" alt="" width="130">
                            </div>
                        </span>
                    </h1>
                    <h1 class="birthday">
                        <span style="--t: 5s;">B</span>
                        <span style="--t: 5.2s;">i</span>
                        <span style="--t: 5.4s;">r</span>
                        <span style="--t: 5.6s;">t</span>
                        <span style="--t: 5.8s;">h</span>
                        <span style="--t: 6s;">d</span>
                        <span style="--t: 6.2s;">a</span>
                        <span style="--t: 6.4s;">y</span>
                    </h1>
                    
                </div>
                <div class="date__of__birth">
                    <span></span>
                </div>


                <div class="btn mail">
                    <button id="btn__letter">
                       Ấn vào đây đi vợ 😒
                        <i class="fa-regular fa-envelope"></i>
                    </button>
                </div>

            </div>
            <div class="right">
                <div class="box__account">
                    <div class="image">
                        <img style="position: relative; bottom:-25px;" src="./images/z7069593462920_4503e4c1f882e39317e12d5dcb5be64d.jpg" alt="">
                    </div>
                    <div class="name">
                        <i class="fa-solid fa-heart"></i>
                        <span>Nguyễn Phương Anh</span>
                        <i class="fa-solid fa-heart"></i>
                    </div>
                    <div class="balloon_one">
                        <img width="100px" src="./images/balloon1.png" alt="">
                    </div>
                    <div class="balloon_two">
                        <img width="100px" src="./images/balloon2.png" alt="">
                    </div>
                </div>
                <!-- Original jumping Hello Kitty - Giữ nguyên -->
                <div class="hello-kitty">
                    <img src="images/icegif-516.gif" alt="Hello Kitty Jumping">
                </div>
                <div class="cricle">
                    <div class="text__cricle">
                        <span style="--i: 1;">h</span>
                        <span style="--i: 2;">a</span>
                        <span style="--i: 3;">p</span>
                        <span style="--i: 4;">p</span>
                        <span style="--i: 5;">y</span>
                        <span style="--i: 6;">-</span>
                        <span style="--i: 7;">b</span>
                        <span style="--i: 8;">i</span>
                        <span style="--i: 9;">r</span>
                        <span style="--i: 10;">t</span>
                        <span style="--i: 11;">h</span>
                        <span style="--i: 12;">d</span>
                        <span style="--i: 13;">a</span>
                        <span style="--i: 14;">y</span>
                        <span style="--i: 15;">-</span>
                    </div>
                    <i class="fa-solid fa-heart"></i>
                </div>
                <span class="day">
                    
                </span>
                <span class="month"></span>
            </div>
        </div>
        <div class="decorate_star star1" style="--t: 15s;"></div>
        <div class="decorate_star star2" style="--t: 15.2s;"></div>
        <div class="decorate_star star3" style="--t: 15.4s;"></div>
        <div class="decorate_star star4" style="--t: 15.6s;"></div>
        <div class="decorate_star star5" style="--t: 15.8s;"></div>
        <div class="decorate_flower--one" style="--t: 15s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_flower--two" style="--t: 15.3s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_flower--three" style="--t: 15.6s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_bottom">
            <img src="./images/decorate.png" alt="" width="100">
        </div>
        <div class="smiley__icon">
            <img src="./images/smiley_icon.png" alt="" width="100">
        </div>

        

        <div class="box__letter">
            <div class="letter__border">
                <div class="letter">
                    <div class="title__letter">
                    </div>
                    <div class="content__letter">
                        <div class="left">
                            <img id="heart__letter" src="./images/heart_letter.png" alt="">
                            <img class="heart heart_1" style="--t: 0.2s" width="20" src="./images/heart.png" alt="">
                            <img class="heart heart_2" style="--t: 0.4s" width="20" src="./images/heart.png" alt="">
                            <img class="heart heart_3" style="--t: 0.6s" width="20" src="./images/heart.png" alt="">
                            <img class="heart heart_4" style="--t: 0.8s" width="20" src="./images/heart.png" alt="">
                        </div>
                        <div class="right">
                            <div class="love__img">
                                <img src="./images/love.png" alt="" width="220">
                            </div>
                            <div class="text__letter">
                                 <p></p>
                            </div>
                            <img id="mewmew" width="80" src="./images/mewmew.gif" alt="">
                        </div>
                    </div>
                </div>
                <div class="close">
                    <i class="fa-solid fa-xmark"></i>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    let datetxt = "2 - 10 - 2009";
    let datatxtletter = "";
    let titleLetter = " ";
    let charArrDate = datetxt.split('');
    let charArrDateLetter = datatxtletter.split('');
    let charArrTitle = titleLetter.split('');
    let currentIndex = 0;
    let currentIndexLetter = 0;
    let currentIndexTitle = 0;
    let date__of__birth = document.querySelector(".date__of__birth span");
    let text__letter = document.querySelector(".text__letter p");
    let userName = "";

    setTimeout(function(){
        timeDatetxt = setInterval(function(){
            if(currentIndex < charArrDate.length){
                date__of__birth.textContent += charArrDate[currentIndex];
                currentIndex++;
            }
            else{
                let i = document.createElement("i");
                i.className = "fa-solid fa-star"
                document.querySelector(".date__of__birth").prepend(i)
                document.querySelector(".date__of__birth").appendChild(i.cloneNode(true))
                clearInterval(timeDatetxt)
            }
        },100)
    },12000)

    var intervalContent;
    var intervalTitle;
    $("#btn__letter").on("click", function(){
        $(".box__letter").slideDown()
        setTimeout(function(){
            $(".letter__border").slideDown();
        },1000)
        setTimeout(function(){
            intervalTitle = setInterval(function(){
                if(currentIndexTitle < charArrTitle.length){
                    document.querySelector(".title__letter").textContent += charArrTitle[currentIndexTitle];
                    let i = document.createElement("i");
                    i.className = "fa-solid fa-heart"
                    document.querySelector(".title__letter").appendChild(i)
                    currentIndexTitle++;
                }
                else{
                    clearInterval(intervalTitle)
                }
            },100)
        },2000)
        setTimeout(function(){
            document.querySelector("#heart__letter").classList.add("animationOp");
            document.querySelector(".love__img").classList.add("animationOp");
            document.querySelector("#mewmew").classList.add("animationOp");
        },2800)
        setTimeout(function(){
            document.querySelectorAll(".heart").forEach((item)=>{
                item.classList.add("animation")
            })
        },3500)
        setTimeout(function(){
            intervalContent = setInterval(function(){
                if(currentIndexLetter < charArrDateLetter.length){
                    text__letter.textContent += charArrDateLetter[currentIndexLetter];
                    currentIndexLetter++;
                }
                else{
                    clearInterval(intervalContent)
                }
            },50)
        },6000)
    })
    $(".close").on("click", function(){
        clearInterval(intervalContent)
        document.querySelector(".title__letter").textContent = "";
        text__letter.textContent = "";
        currentIndexLetter = 0
        currentIndexTitle = 0
        document.querySelector("#heart__letter").classList.remove("animationOp");
        document.querySelector(".love__img").classList.remove("animationOp");
        document.querySelector("#mewmew").classList.remove("animationOp");
        document.querySelectorAll(".heart").forEach((item)=>{
                item.classList.remove("animation")
            })
        $(".box__letter").slideUp();
        $(".letter__border").slideUp();
    })

   function updateLetterContent() {
    titleLetter = `Gửi ${userName}, `;
    datatxtletter = `Hôm nay là sinh nhật của nhóc. Anh chúc nhóc tuổi mới thật nhiều niềm vui, ngày càng xinh đẹp, đáng iu, ngol và học giỏi hơn nữa nhé. 16 tuổi rồi, không còn bé nữa đâu nhưng với anh, Bông mãi là em bé đáng yêu nhất trên đời của anh. Anh yêu em nhiều lắm ❤️ Happy Birthday, my one and only!`;
    charArrTitle = titleLetter.split('');
    charArrDateLetter = charArrTitle.concat(datatxtletter.split(''));
}


    $('#submitName').on('click', function() {
        userName = $('#nameInput').val();
        if (userName) {
            $('#nameModal').hide();
            $('.content').show();
            updateLetterContent();
        } else {
            alert('Vui lòng nhập tên của bạn.');
        }
    });

    //mobile

    function mobile(){
        const app = {
            timeout: function(txt, dom){
                let currentIndex = 0;
                let charArr = txt.split('')
                intervalMobile = setInterval(function(){
                    if(currentIndex < charArr.length){
                        dom.textContent += charArr[currentIndex];
                        currentIndex++;
                    }
                    else{
                        clearInterval(intervalMobile)
                    }
                },200)
            }
        }
        return app
    }
    const fcMobile = mobile()
    if(window.innerWidth < 768){
        setTimeout(()=>{
            fcMobile.timeout("26", document.querySelector(".day"))
        },5000)
        setTimeout(()=>{
            fcMobile.timeout("10", document.querySelector(".month"))
        },6000)
    }
    
</script>

<script>
    window.onload = function() {  
        var audio = document.getElementById('myAudio');  
        audio.play().catch(function(error) {  
            console.log("Không thể tự động phát âm thanh: ", error);  
        });  
        // Bắt đầu pháo hoa khi load trang, dừng sau 10 giây
        confettiBurst();
        setTimeout(() => {
            stopConfetti();
        }, 10000);
    };  

</script>

<audio id="myAudio" loop autoplay>  
<source src="./ytmp3free.cc_happy-birthday-piano-instrumental-by-hsc501-youtubemp3free.org.mp3" type="audio/mpeg">  
</audio> 

    // Giảm tần suất bằng cách dùng throttle (chỉ tạo mỗi 100ms)
    let lastHeartTime = 0;
    document.addEventListener('mousemove', function(e){
        const now = Date.now();
        if (now - lastHeartTime < 100) return; // Throttle: chỉ tạo mỗi 100ms
        lastHeartTime = now;

        let body = document.querySelector('body');
        let heart = document.createElement('span');
        let x = e.clientX; // Dùng clientX thay offsetX để fixed
        let y = e.clientY;
        heart.style.position = 'fixed'; // Fixed để không ảnh hưởng layout
        heart.style.left = x + 'px';
        heart.style.top = y + 'px';
        heart.innerHTML = '💖'; // Use emoji for heart

        let size = Math.random() * 10 + 10;
        heart.style.fontSize = size + 'px';

        let transformValue = Math.random() * 360;
        heart.style.transform = 'rotate('+ transformValue +'deg)';

        body.appendChild(heart);

        setTimeout(function(){
            heart.remove();
        },1500)
    })

    // Add floating hearts periodically - Tăng interval lên 4000ms để giảm tần suất
    setInterval(function() {
        let heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.innerHTML = '💕';
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.top = '100vh'; // Bắt đầu từ dưới màn hình
        heart.style.animationDuration = (Math.random() * 3 + 2) + 's';
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 5000);
    }, 4000); // Tăng từ 2000ms lên 4000ms

    let mailBox = document.querySelector('.mail')
    let boxmail = document.querySelector('.boxMail')
    var close = document.querySelector('.fa-xmark')
    if (mailBox) { // Kiểm tra tồn tại
        mailBox.onclick = function(){
            mailBox.classList.toggle('active')
            if (boxmail) {
                boxmail.classList.add('active')
            }
        }
    }

    if (close) { // Kiểm tra tồn tại
        close.addEventListener('click', function(){
            if (boxmail) {
                boxmail.classList.remove('active')
            }
        })
    }

    // Hiệu ứng pháo hoa nổ - Canvas cho confetti, chạy 10 giây
    let animationId;
    function confettiBurst() {
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const confetti = [];
        const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#54a0ff'];

        for (let i = 0; i < 100; i++) {
            confetti.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                r: Math.random() * 4 + 1,
                d: Math.random() * 10 + 10,
                color: colors[Math.floor(Math.random() * colors.length)],
                tilt: Math.random() * 10 - 10,
                tiltAngle: 0
            });
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            confetti.forEach((c, i) => {
                c.tiltAngle += 0.1;
                c.y += c.d;
                c.tilt = Math.sin(c.tiltAngle) * 15;

                if (c.y > canvas.height) {
                    c.x = Math.random() * canvas.width;
                    c.y = Math.random() * canvas.height - canvas.height;
                }

                ctx.beginPath();
                ctx.lineWidth = c.r;
                ctx.strokeStyle = c.color;
                ctx.moveTo(c.x + c.tilt + c.r / 4, c.y);
                ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r / 4);
                ctx.stroke();
            });
            animationId = requestAnimationFrame(draw);
        }
        draw();
    }

    function stopConfetti() {
        if (animationId) {
            cancelAnimationFrame(animationId);
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
    }

    // Thêm touch events cho mobile để tạo hearts khi chạm
    document.addEventListener('touchstart', function(e) {
        e.preventDefault();
        const touch = e.touches[0];
        const x = touch.clientX;
        const y = touch.clientY;

        let body = document.querySelector('body');
        let heart = document.createElement('span');
        heart.style.position = 'fixed';
        heart.style.left = x + 'px';
        heart.style.top = y + 'px';
        heart.innerHTML = '💖';

        let size = Math.random() * 10 + 10;
        heart.style.fontSize = size + 'px';

        let transformValue = Math.random() * 360;
        heart.style.transform = 'rotate('+ transformValue +'deg)';

        body.appendChild(heart);

        setTimeout(function(){
            heart.remove();
        },1500);
    }, { passive: false });

    // Resize canvas on window resize for mobile
    window.addEventListener('resize', function() {
        const canvas = document.getElementById('confetti-canvas');
        if (canvas) {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
    });
</script>
</html>